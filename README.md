# Directory Analysis

**Простой интерактивный анализатор файлов и кода на Nim**
Позволяет сканировать директории, собирать метрики по файлам и строкам исходного кода, а также экспортировать результаты в разных форматах.

---

## Описание

`Directory Analysis` рекурсивно сканирует выбранную директорию, подсчитывает строки кода, комментариев и пустых строк (для текстовых файлов), а также собирает общую статистику по любым типам файлов.
Работает в интерактивном режиме и поддерживает экспорт отчётов в JSON, CSV и HTML.

---

## Основные возможности

* Интерактивная навигация по директориям (вход в подпапки, «Вверх», «Остаться здесь»).
* Выбор предустановленных наборов расширений или анализ всех файлов.
* Подсчёт строк кода / комментариев / пустых строк для исходников.
* Общая статистика: количество файлов, общий размер, минимальный, средний и максимальный размер.
* Прогресс-бар при больших объёмах данных.
* Экспорт отчёта в **JSON**, **CSV** или **HTML** с автогенерацией имени:
  `code_metrics_YYYY-MM-DD-HH-mm-ss.<ext>`.

---

## Требования

* **Nim 2.2.4** (тестировалось на Windows).
  Убедитесь, что компилятор `nim` доступен через `PATH`.

---

## Как запустить

Компиляция и запуск через C++ бэкенд:

```bash
nim cpp --run main.nim
```

```bash
nim cpp --run server.nim
```

---

## Интерактивный сценарий

1. **Выбор директории**

   * выбрать текущую;
   * ввести путь вручную;
   * перемещаться по подпапкам.

2. **Выбор набора расширений**

   * предустановленные типы исходников (например, `.nim`, `.py`, `.cpp` и т.д.);
   * либо анализ всех файлов.

3. **Режим вывода**

   * вывод в терминал;
   * или экспорт отчёта (JSON / CSV / HTML).
     При экспорте прогресс-бар и подробный per-file вывод отключаются.

---

## Производительность и советы

* При анализе больших директорий (десятки гигабайт) возможна длительная обработка.
  Лучше сохранять результат в файл для удобства.
* Для анализа только исходников используйте готовые наборы расширений.

Папка объёмом **~40 ГБ** анализируется примерно **за 13 минут** (зависит от CPU, диска и числа потоков).

---

## Форматы выходных файлов

* **JSON** — структурированный отчёт с секциями `summary` и `byExtension`.
* **CSV** — сводная статистика и построчная детализация по расширениям.
* **HTML** — читаемый отчёт с таблицей и базовой стилизацией.

Все файлы сохраняются в **рабочей директории**, из которой был запущен анализ.

---

# Directory Analysis — Command & Control Component

Компонент централизованного управления и координации для системы анализа директорий.
Реализует C2-архитектуру (Command & Control) для распределённого сканирования файловых систем.

---

## Назначение

* Централизованное управление задачами анализа
* Координация множества удалённых агентов
* Сбор и агрегация результатов
* Удалённое выполнение команд сканирования

---

## Архитектура

### Основной репозиторий предоставляет:

* Логику анализа файлов и директорий
* Алгоритмы подсчёта метрик
* Форматы и структуры данных

### Данный компонент добавляет:

* Сетевую коммуникацию (HTTP/REST API)
* Управление и мониторинг агентов
* Очередь задач и планировщик сканирований
* Безопасную передачу данных и аутентификацию

---

## Пример сценария

1. Центральный сервер C2 получает команду на анализ директории.
2. Агент на удалённой машине выполняет сканирование и отправляет отчёт.
3. Сервер агрегирует результаты и сохраняет их в централизованное хранилище.
