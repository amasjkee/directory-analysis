Code Metrics — простой интерактивный анализатор файлов и кода
=============================================================

Описание
--------

Эта утилита на Nim сканирует указанную директорию рекурсивно, собирает метрики по файлам и (при наличии текстовых исходников) по строкам кода.

Основные возможности
--------------------

- Интерактивный выбор директории (навигация: вход в подпапки, «Вверх», «Остаться здесь»).
- Выбор предустановленных наборов расширений или анализ всех файлов.
- Подсчёт строк кода / комментариев / пустых строк для текстовых исходников.
- Универсальная статистика для любых файлов: количество, общий размер, средний/макс/мин размер.
- Прогресс-бар при обработке большого количества файлов.
- Экспорт отчёта в JSON, CSV или HTML (файл создаётся в рабочей директории и называется `code_metrics_YYYY-MM-DD-HH-mm-ss.<ext>`).

Требования
----------

- Nim (тестировалось с Nim 2.x на Windows). Убедитесь, что `nim` доступен в PATH.

Как запустить
------------

```pwsh
nim cpp --run main.nim
```

или (быстрая компиляция и запуск):

```pwsh
nim c -r main.nim
```

Интерактивный сценарий
----------------------

1. Программа попросит выбрать директорию для анализа. Можно:
   - выбрать текущую директорию;
   - ввести путь вручную;
   - перемещаться по списку подпапок

2. Выберите типы файлов для анализа (предустановленные наборы или все файлы).

3. Программа предложит режим экспорта: вывод в терминал или сохранение в файл (JSON/CSV/HTML).
   - Если вы выберете файл, подробный per-file вывод и прогресс-бар отключаются, и всё сохраняется в файл.
   - Сгенерированный файл появляется в текущей рабочей директории и имеет имя `code_metrics_YYYY-MM-DD-HH-mm-ss.<ext>`.

Производительность и советы
---------------------------

- При работе с очень большими директориями (десятки ГБ) анализ может занять значительное время. Программа подсчитает количество файлов и предложит сохранить результаты в файл — это рекомендуется для удобства.
- Если нужно проанализировать только исходники — выбирайте соответствующий набор расширений (рекомендуется).

Формат выходных файлов
----------------------

- JSON: структурированный отчёт с секциями `summary` и `byExtension`.
- CSV: первая строка — сводная статистика, затем раздел с построчной статистикой по расширениям.
- HTML: читаемый веб-отчёт с таблицей и базовой стилизацией.

Где сохраняются файлы
---------------------

По умолчанию — в той директории, откуда вы запускали программу (рабочая директория).

Пример: результаты для большой папки
-----------------------------------

Примерно анализ папки ~40 ГБ завершился за ~13 минут — это реальное измерение в конкретной среде (процессор, диск, параллелизм и т.д. влияют на скорость).

Отладка и ошибки
----------------

- Если программа пишет, что не может прочитать файл — проверьте права доступа.
- Если вы видите много вывода в терминал при экспорте в файл, проверьте, выбрали ли вы формат файла на этапе "Выберите формат вывода".

Дальнейшие улучшения (идеи)
--------------------------

- Опция выбора каталога для сохранения отчёта (включая абсолютный путь).
- Параллельная обработка файлов для ускорения.
- Более точная классификация типов файлов по сигнатурам, а не только по расширениям.